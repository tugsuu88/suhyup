<%@ page import="java.util.*, util.* java.text.* " contentType="text/html;charset=euc-kr"%><%@ include file="include/admin_session.jsp" %><%@ include file="include/logincheck.jsp" %><%@ include file="include/top_login.jsp" %><%@ include file="include/top_menu08.jsp" %><jsp:useBean id="FrontBoard" scope="session" class="Bean.Front.Common.FrontBoradType1"/><jsp:useBean id="FrontDbUtil" scope="session" class="Bean.Front.Common.FrontDbUtil"/><jsp:useBean id="AdminInfo" scope="request" class="board.admin.AdminInfo"/><%	String mode = Converter.nullchk(request.getParameter("mode"));    if (mode.equals("")) mode="add";//   	out.println("mode : " + mode + "<br>");    	String PAGE = Converter.nullchk(request.getParameter("PAGE"));	if(PAGE == null || PAGE.equals("")) {		PAGE = "1";	}	String KEY = Converter.nullchk(request.getParameter("KEY"));	//검색어	if(KEY != null && !KEY.equals("")) {		KEY = StringReplace.sqlFilter(KEY);		//금지어 필터링	}	//out.println("KEY : " + KEY + "<br>");	String FIELD = Converter.nullchk(request.getParameter("FIELD"));	//검색구분	String sh_seq_no = "";	String sh_title = "";	String sh_reg_writer = "";	String sh_content = "";	String sh_hit_cnt = "0";	String sh_reg_dt = "";	String msg = "";	String btn_name = "";	if(mode.equals("add")) {		msg = "등록";		btn_name = "record.gif";	} else {		msg = "수정";		btn_name = "adjust.gif";		sh_seq_no = Converter.nullchk(request.getParameter("sh_seq_no"));		String TableName = " sh_commodity ";		String SelectCondition = null;		String WhereCondition = null;		String OrderCondition = null;		if(sh_seq_no == null || sh_seq_no.equals("")) sh_seq_no = "0";		SelectCondition = " sh_seq_no, sh_title, sh_content, sh_reg_writer, sh_hit_cnt, to_char(sh_reg_dt, 'YYYY-MM-DD') AS sh_reg_dt ";				WhereCondition  = " where sh_seq_no =  " + Integer.parseInt(sh_seq_no) ;		OrderCondition  = " ORDER BY sh_seq_no ";		Vector ResultVector = FrontBoard.list(TableName, SelectCondition, WhereCondition, OrderCondition, 1, 1);		if( ResultVector.size() > 0){			for (int i=0; i < ResultVector.size();i++){				Hashtable h = (Hashtable)ResultVector.elementAt(i);								sh_seq_no = (String)h.get("SH_SEQ_NO");				sh_title = (String)h.get("SH_TITLE");				sh_content = (String)h.get("SH_CONTENT");				sh_reg_writer = (String)h.get("SH_REG_WRITER");				sh_hit_cnt = (String)h.get("SH_HIT_CNT");						sh_reg_dt = (String)h.get("SH_REG_DT");					}		}	}%><html><head><script language="javascript" src="/js/common.js"></script><script language="javascript">	extArray = new Array( "asp", "php", "cgi", "sh", "php3", "php4", "html", "htm", "inc", "jsp", "exe", "com", "bat", "htc", "hta" );	//파일을 선택 후 포커스 이동시 호출	function uploadFile_Change( value ){    	var src = getFileExtension(value);    	if (src == "") {        	alert("올바른 파일을 입력하세요");        	return;    	/*} else if ( src.toLowerCase() == "exe" ) {        	alert("실행 파일은 첨부 할 수 없습니다.");        	return;    	}*/    	}else{    		for (var i = 0; i < extArray.length; i++) {				if (extArray[i] == src.toLowerCase()) {					alert("첨부 할 수 없는 파일 확장자 입니다.");					return;				}			}		}	}		//파일 폼 추가	function FieldAdd(vn_paremeter){		if ( vn_paremeter == 1 ){	  		if ( f.count.value == 1 ) { f.count.value=2; f.file2.style.height = 20; f.file2.style.visibility = 'visible'; return;}	  		if ( f.count.value == 2 ) { f.count.value=3; f.file3.style.height = 20; f.file3.style.visibility = 'visible'; return;}	  		if ( f.count.value == 3 ) { f.count.value=4; f.file4.style.height = 20; f.file4.style.visibility = 'visible'; return;}	  		if ( f.count.value == 4 ) { f.count.value=5; f.file5.style.height = 20; f.file5.style.visibility = 'visible'; return;}	  		if ( f.count.value == 5 ) { alert('첨부파일은 5개까지 가능합니다.'); return;}	 	}		if ( vn_paremeter == 2 ){	  		if ( f.count.value == 1 ) { return; }	  		if ( f.count.value == 2 ) { f.count.value=1; f.file2.style.height = 1; f.file2.style.visibility = 'hidden'; return;}	  		if ( f.count.value == 3 ) { f.count.value=2; f.file3.style.height = 1; f.file3.style.visibility = 'hidden'; return;}	  		if ( f.count.value == 4 ) { f.count.value=3; f.file4.style.height = 1; f.file4.style.visibility = 'hidden'; return;}	  		if ( f.count.value == 5 ) { f.count.value=4; f.file5.style.height = 1; f.file5.style.visibility = 'hidden'; return;}	 	}	}	//약관 동의 여부 체크	function GoReg() {				if (f.sh_title.value.length == 0  ) {			alert("제목을 입력해 주십시오");			f.sh_title.focus();			return;		}		//특수문자 체크: + ; ( ) - 는 가능		var keyword = f.sh_content.value;		var keyword_sp_char = "`@#$%^&*=|\\<,>:\'";				if(CheckSpecialChar(keyword, keyword_sp_char) == false)			{				alert("특수문자(" + keyword_sp_char + ")를 입력하실 수 없습니다.");				f.sh_content.focus();				return;			}					if (f.sh_content.value.length == 0 ) {			alert("답변을 입력해 주십시오");			f.sh_content.focus();			return;		}				f.action = "commodity_write_proc.jsp";		f.encoding="multipart/form-data";		f.submit();	}		function GoDel() {		if(confirm("삭제하시겠습니까?")){			f.mode.value = "del"   			f.action = "commodity_write_proc.jsp";   			f.encoding="multipart/form-data";			f.submit();		}else{			return;		}	}		//첨부파일 삭제	function goFileDel(file_no) {		if (confirm("선택한 파일을 삭제하시겠습니까?")) {			f.mode.value = "filedel"			f.file_no.value = file_no;			f.action = "commodity_del_proc.jsp";			f.encoding="multipart/form-data";			f.submit();		}		/*else {			pbform.reset();		}*/	}</script></head><form method=post action="" name="f" enctype="multipart/form-data"><input type="hidden" name="sh_reg_writer" value="<%=sa_name%>" ><input type="hidden" name="sh_seq_no" value="<%=sh_seq_no%>" ><input type="hidden" name="mode" value="<%=mode%>"><input type="hidden" name="file_no" value=""><table width="680" cellspacing="0" cellpadding="0" border="0">	<tbody><tr>		<td height="2" class="board_topline" colspan="6"></td>	</tr>		<% if(mode.equals("edit")) { %>	<tr height="30">		<td width="100" align="center" class="board_bg_title">제목</td>		<td width="580" class="write_padding" colspan="5">			<input type="text" value="<%=sh_title%>" class="input01" size="90" name="sh_title">		</td>	</tr>	<tr height="30">		<td width="100" align="center" class="board_bg_title">작성자</td>		<td width="90" class="write_padding"><%=sh_reg_writer%></td>		<td width="100" align="center" class="board_bg_title">등록일</td>		<td width="100" class="write_padding"><%=sh_reg_dt%></td>		<td width="100" align="center" class="board_bg_title">조회수</td>		<td width="90" class="write_padding"><%=sh_hit_cnt%></td>	</tr>			<% }else{ %>	<tr height="30">		<td width="100" align="center" class="board_bg_title">제목</td>		<td width="580" class="write_padding" colspan="5">			<input type="text" value="" class="input01" size="90" name="sh_title" value="<%=sh_title%>">		</td>	</tr>	<tr>         <td height="1" colspan="6" class="board_line"></td>	</tr>		<tr height="30">		<td width="100" align="center" class="board_bg_title">작성자</td>		<td width="580" class="write_padding" colspan="5"><%=sa_name%></td>	</tr>	<tr>         <td height="1" colspan="6" class="board_line"></td>	</tr>		<% } %>		<tr height="30"> 		<td class="write_padding" colspan="6">			<textarea wrap="virtual" class="input01" rows="10" cols="25" id="sh_content" name="sh_content" style="width:655px; padding:10px;"><%=sh_content%></textarea>		</td>	</tr>	<tr>         <td height="1" colspan="6" class="board_line"></td>	</tr>	<tr height="30">		<td width="100" align="center" class="board_bg_title">첨부파일</td>		<td class="write_padding" colspan="5">			<input type="hidden" value="1" name="count">			<%				if(mode.equals("edit")) {					String TableName2 = " sh_board_file3 ";	   				String SelectCondition2 = " file_no, sh_no, file_name, file_size, file_count ";		    		String WhereCondition2  = " where sh_no =  " + Integer.parseInt(sh_seq_no) ;		    		String OrderCondition2  = " ORDER BY file_no ";					Vector ResultVector2 = FrontBoard.list(TableName2, SelectCondition2, WhereCondition2, OrderCondition2, 1, 0, 0);					if( ResultVector2.size() > 0){						for (int i=0; i < ResultVector2.size();i++){							Hashtable h = (Hashtable)ResultVector2.elementAt(i);			%>							<input type="hidden" name="file_no<%=i+1%>" value="<%=(String)h.get("FILE_NO")%>">							<img src="../images/common/icon_file.gif" border="0" align="absmiddle">&nbsp;							<a href="download.jsp?sh_no=<%=sh_seq_no%>&file_no=<%=(String)h.get("FILE_NO")%>"><%=(String)h.get("FILE_NAME")%></a>&nbsp;							<a href="javascript:goFileDel('<%=(String)h.get("FILE_NO")%>');"><img src="../images/common/re_del.gif" border="0" align="absmiddle"></a><br>							<% if(i==0){ %>							<input name="file<%=i+1%>" type="file" class="input01" size="70" onChange="uploadFile_Change( this.value );">							<a href="javascript:FieldAdd(1);"><img src="../images/button/ico_plus.gif" border="0" align="absmiddle"></a>							<a href="javascript:FieldAdd(2);"><img src="../images/button/ico_minus.gif" border="0" align="absmiddle"></a><br>							<% }else{ %>							<input name="file<%=i+1%>" type="file" class="input01" size="70" onChange="uploadFile_Change( this.value );"><br>							<% } %>			<%						}						if(ResultVector2.size() < 5) {							//int j = ResultVector2.size();							for (int j=ResultVector2.size(); j<5; j++){			%>								<input type="hidden" name="file_no<%=j+1%>" value="">								<input name="file<%=j+1%>" type="file" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>			<%							}						}					} else {			%>						<input type="file" name="file1" class="input01" size="70" onChange="uploadFile_Change( this.value );">						<a href="javascript:FieldAdd(1);"><img src="../images/button/ico_plus.gif" border="0" align="absmiddle"></a>						<a href="javascript:FieldAdd(2);"><img src="../images/button/ico_minus.gif" border="0" align="absmiddle"></a><br>						<input type="file" name="file2" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>						<input type="file" name="file3" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>						<input type="file" name="file4" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>						<input type="file" name="file5" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>			<%					}				} else {			%>					<input type="file" name="file1" class="input01" size="70" onChange="uploadFile_Change( this.value );">					<a href="javascript:FieldAdd(1);"><img src="../images/button/ico_plus.gif" border="0" align="absmiddle"></a>					<a href="javascript:FieldAdd(2);"><img src="../images/button/ico_minus.gif" border="0" align="absmiddle"></a><br>					<input type="file" name="file2" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>					<input type="file" name="file3" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>					<input type="file" name="file4" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>					<input type="file" name="file5" class="input01" size="70" style="visibility:hidden; height:1px;" onChange="uploadFile_Change( this.value );"><br>			<% 	} %>			<font color="#947142">( <img align="absmiddle" border="0" src="../images/common/refer1_ico.gif">  파일명은 띄어쓰기 없는 영문 파일명만 가능합니다. )</font>		</td>	</tr>	<tr>         <td height="1" colspan="6" class="board_line"></td>	</tr></tbody></table><br><table width="680" cellspacing="0" cellpadding="0" border="0">	<tbody>		<tr>	    	<td width="10"></td>	    	<!-- <td><a href="commodity.jsp?sh_site=1&amp;sh_class=218&amp;PAGE=1&amp;FIELD=&amp;KEY="><img align="absmiddle" border="0" src="../images/button/list.gif"></a></td> -->	    	<td><a href="commodity.jsp?PAGE=<%=PAGE%>&FIELD=<%=FIELD%>&KEY=<%=KEY%>"><img src="../images/button/list.gif" border="0" align="absmiddle"></a></td>	    	<td width="59"><a href="javascript:GoReg();"><img src="../images/button/<%=btn_name%>" border="0" align="absmiddle"></a></td>	    		    	<% if(mode.equals("edit")) { %>		    		<td width="120">		    			<a href="javascript:GoDel();"><img src="../images/button/del.gif" border="0" align="absmiddle"></a>		    		</td>		    	<% } %>	    		    	<td width="56"><!--<a href="javascript:history.go(-1)"><img align="absmiddle" border="0" src="../images/button/cancel.gif"></a> --></td>	    	<td width="10"></td>		</tr></tbody></table><br><input type="hidden" value="114140457257" name="s8fid"></form></html><%@ include file="include/bottom.jsp" %>